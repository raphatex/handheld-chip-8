TextPack
========

TextPack is a utility for preparing font and string data for Chip8 programs. Font data is read in as a vertical strip of 8xN characters. A simple compression algorithm overlaps characters in the font data where possible, and then strings are encoded as a sequence of byte offsets from the beginning of the font data.

Compiling:

	javac TextPack.java
	java TextPack
	usage: textpack [--toimage] [--strip] <font> <alphabet> <text>

The `font` argument should be an 8xN vertical strip of characters stored as an image file. The `alphabet` defines the sequence of characters as they appear in the font. Character heights are inferred from the size of the font file and the length of the alphabet. The `text` argument is the string you wish to encode.

	java TextPack font4x5.png 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!` ' 'SOME TEXT'
	: font4x5 # (112 bytes)
		0xF0 0x40 0x40 0x40 0x40 0x90 0x90 0x70
		0x10 0xE0 0x20 0x20 0x20 0x00 0x20 0x40
		0x00 0x00 0x00 0x00 0x00 0xE0 0x90 0xE0
		0x90 0x90 0x90 0xE0 0x90 0xE0 0x90 0xE0
		0x80 0x80 0xD0 0xB0 0xB0 0x90 0x90 0x90
		0x90 0x60 0x60 0x90 0x90 0x90 0x60 0x90
		0xF0 0x90 0x90 0xF0 0x90 0x90 0xD0 0xB0
		0x90 0x90 0x90 0x50 0x20 0xF0 0x80 0xE0
		0x80 0x80 0x80 0x80 0xF0 0x80 0xE0 0x80
		0xF0 0x40 0x40 0x40 0xF0 0x60 0x90 0x80
		0x90 0x60 0x90 0x90 0xB0 0x70 0x80 0xB0
		0x90 0x70 0x80 0x60 0x10 0xE0 0x90 0xA0
		0xC0 0xA0 0x90 0x90 0xB0 0xB0 0xD0 0xF0
		0x20 0x40 0x80 0xF0 0x20 0x20 0x20 0xC0
	
	: text # (9 bytes)
		0x59 0x2A 0x22 0x44 0x10 0x00 0x44 0x28
		0x00 

The `--toimage` option writes compressed font data to a PNG for convenient visual inspection.

The `--strip` option removes characters from the font before compression if they are not used in the `text` string.

Here is an Octo program which can display text in the format TextPack produces:

	: main
		va := 2 # cursor x
		vb := 1 # cursor y
		vc := 0 # character index
		loop
			i := text
			i += vc
			load v0
			i := font4x5
			i += v0
			sprite va vb 5

			va += 5
			# assume lores screen bounds
			if va == 62 then vb += 6
			if va == 62 then va := 2

			vc += 1
			# string length check
			if vc != 22 then
		again
		loop again

	: font4x5 # (50 bytes)
		0x70 0x80 0x60 0x10 0xE0 0x90 0xE0 0x80
		0x80 0xE0 0x90 0xE0 0x90 0x90 0x00 0x00
		0x00 0x00 0x00 0x90 0x60 0x60 0x90 0x90
		0x90 0x60 0x90 0xF0 0x90 0x90 0xF0 0x90
		0x90 0xD0 0xB0 0xB0 0x90 0x90 0xB0 0xB0
		0xD0 0xF0 0x80 0xE0 0x80 0xF0 0x40 0x40
		0x40 0x40 
	: text # (22 bytes)
		0x00 0x15 0x21 0x29 0x0E 0x2D 0x29 0x13
		0x2D 0x0E 0x0E 0x0E 0x2D 0x1C 0x19 0x2D
		0x0E 0x24 0x09 0x19 0x04 0x00 

Note that for SuperChip high resolution mode the screen boundaries would need to be adjusted, and for a general-purpose string drawing routine it would be necessary to store the string length in a register and provide indirect access to the string data either with a lookup table or using self-modifying code and `:unpack`.
